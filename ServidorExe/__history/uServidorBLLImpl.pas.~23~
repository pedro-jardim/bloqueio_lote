{ Invokable implementation File for TServidorBLL which implements IServidorBLL }

unit uServidorBLLImpl;

interface

uses
  Soap.InvokeRegistry, System.Types, Soap.XSBuiltIns, uServidorBLLIntf, System.Classes;



type

  { TServidorBLL }
  TServidorBLL = class(TInvokableClass, IServidorBLL)
  public
    function mensagemBoasVindas: String;
    function envioLaudoLoteBloqueado(const xml: WideString): WideString;
    function envioEncerramentoLote(const xml: WideString):WideString;
  end;

implementation

uses
  Xml.xmldom, Xml.XMLIntf, Xml.XMLDoc;

{ TServidorBLL }

function TServidorBLL.envioEncerramentoLote(const xml: WideString): WideString;
var
  lxml : IXMLDocument;
  lNodeListaProdutos, lNodeProduto, lNode: IXMLNode;
begin
  lxml := NewXMLDocument;
  lNode := lxml.AddChild('Retorno');
  lNode.Attributes['xml'] := xml;
  lxml.SaveToFile('C:\Pedro\Arquivo.xml');

  lxml.XML.Clear;
  lNodeListaProdutos := lxml.CreateNode('ListaProdutos');
  lNodeListaProdutos.AddChild('Produto').AddChild('Nome').Text := 'Macarrão';
  lNodeListaProdutos.AddChild('Produto').AddChild('Valor').Text := '120.90';
  lNodeListaProdutos.AddChild('Produto').AddChild('Nome').Text := 'Arroz';
  lNodeListaProdutos.AddChild('Produto').AddChild('Valor').Text := '36.99';
  Result := lNodeListaProdutos.XML;
end;

function TServidorBLL.envioLaudoLoteBloqueado(
  const xml: WideString): WideString;
begin

end;

function TServidorBLL.mensagemBoasVindas: String;
begin
  Result := 'Servidor SOAP da GBS';
end;

initialization
{ Invokable classes must be registered }
   InvRegistry.RegisterInvokableClass(TServidorBLL);
end.

